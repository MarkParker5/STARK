<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <title>Benchmark Report Viewer</title>
        <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
        <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
        <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    </head>

    <body class="bg-gray-50">
        <div id="root"></div>
        <script type="text/babel">
            const { useState } = React;

            const BenchmarkViewer = () => {
                const defaultData = `
--------------------------
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.EXACT-True-1000]                          6.5226 (1.0)            7.2287 (1.0)            7.0069 (1.0)           0.1980 (1.31)          7.0562 (1.0)           0.1589 (1.0)           2;1  142.7172 (1.0)          10         148
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.EXACT-True-100]                           6.6633 (1.02)           7.7638 (1.07)           7.3819 (1.05)          0.3820 (2.53)          7.4500 (1.06)          0.6571 (4.14)          2;0  135.4663 (0.95)         10         139
test_benchmark__dictionary[sqlite-lookup-LookupMode.EXACT-True-100]                                  6.8863 (1.06)           7.4771 (1.03)           7.1825 (1.03)          0.2141 (1.42)          7.1818 (1.02)          0.3556 (2.24)          4;0  139.2266 (0.98)         10         140
test_benchmark__dictionary[sqlite-lookup-LookupMode.EXACT-True-1000]                                 6.9386 (1.06)           7.8998 (1.09)           7.2175 (1.03)          0.2711 (1.79)          7.1688 (1.02)          0.2290 (1.44)          2;1  138.5518 (0.97)         10         154
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.EXACT-True-100000]                        6.9690 (1.07)           7.9040 (1.09)           7.4878 (1.07)          0.2927 (1.94)          7.5785 (1.07)          0.4523 (2.85)          3;0  133.5513 (0.94)         10         134
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.CONTAINS-True-1000]                       7.4250 (1.14)           8.4176 (1.16)           7.9028 (1.13)          0.3773 (2.50)          7.9139 (1.12)          0.5953 (3.75)          4;0  126.5369 (0.89)         10         139
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.CONTAINS-True-10000]                      7.5508 (1.16)           8.6325 (1.19)           8.0790 (1.15)          0.3649 (2.41)          8.0592 (1.14)          0.4729 (2.98)          4;0  123.7770 (0.87)         10         126
test_benchmark__dictionary[sqlite-lookup-LookupMode.CONTAINS-True-1000]                              7.8024 (1.20)          11.7392 (1.62)           8.9477 (1.28)          1.3285 (8.79)          8.3136 (1.18)          2.1060 (13.26)         2;0  111.7603 (0.78)         10         113
test_benchmark__dictionary[sqlite-lookup-LookupMode.EXACT-True-10000]                                8.0971 (1.24)           9.3847 (1.30)           8.6248 (1.23)          0.4581 (3.03)          8.4359 (1.20)          0.6853 (4.31)          3;0  115.9451 (0.81)         10         119
test_benchmark__dictionary[sqlite-lookup-LookupMode.EXACT-True-100000]                               8.1296 (1.25)           8.9289 (1.24)           8.5569 (1.22)          0.2757 (1.82)          8.5998 (1.22)          0.4099 (2.58)          3;0  116.8644 (0.82)         10         120
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.EXACT-True-10000]                         8.3155 (1.27)           9.9535 (1.38)           8.9175 (1.27)          0.4860 (3.21)          8.8373 (1.25)          0.6314 (3.97)          3;0  112.1384 (0.79)         10         124
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.CONTAINS-True-100]                        8.8085 (1.35)           9.2676 (1.28)           9.0533 (1.29)          0.1512 (1.0)           9.0593 (1.28)          0.2630 (1.66)          4;0  110.4568 (0.77)         10         109
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.EXACT-True-1000000]                       9.3763 (1.44)          10.2587 (1.42)           9.8863 (1.41)          0.2668 (1.76)          9.8907 (1.40)          0.4126 (2.60)          2;0  101.1502 (0.71)         10         105
test_benchmark__dictionary[sqlite-lookup-LookupMode.CONTAINS-True-10000]                             9.5711 (1.47)          13.4646 (1.86)          11.0506 (1.58)          1.4807 (9.79)         10.6487 (1.51)          3.0591 (19.25)         3;0   90.4924 (0.63)         10         100
test_benchmark__dictionary[sqlite-lookup-LookupMode.CONTAINS-True-100]                              11.7827 (1.81)         152.7266 (21.13)         33.8896 (4.84)         42.5715 (281.54)       20.6624 (2.93)         18.0754 (113.77)        1;1   29.5076 (0.21)         10         100
test_benchmark__dictionary[sqlite-lookup-LookupMode.CONTAINS-True-100000]                           17.7341 (2.72)          26.8401 (3.71)          20.8594 (2.98)          3.4378 (22.74)        19.0280 (2.70)          6.1470 (38.69)         2;0   47.9401 (0.34)         10         100
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.CONTAINS-True-100000]                    17.9739 (2.76)          20.4221 (2.83)          18.5603 (2.65)          0.7182 (4.75)         18.3940 (2.61)          0.5430 (3.42)          1;1   53.8784 (0.38)         10         100
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.EXACT-True-10000000]                     20.9791 (3.22)          28.4365 (3.93)          25.4823 (3.64)          2.8951 (19.15)        26.8762 (3.81)          4.2033 (26.46)         3;0   39.2429 (0.27)         10         100
test_benchmark__dictionary[sqlite-lookup-LookupMode.EXACT-True-1000000]                             21.3085 (3.27)          27.5636 (3.81)          25.1575 (3.59)          1.9574 (12.94)        25.4418 (3.61)          2.7381 (17.23)         2;0   39.7495 (0.28)         10         100
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.CONTAINS-True-10000000]                  22.2090 (3.40)          25.2849 (3.50)          23.5669 (3.36)          0.9845 (6.51)         23.5286 (3.33)          0.9844 (6.20)          3;1   42.4324 (0.30)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.CONTAINS-True-100]                     23.5890 (3.62)          25.9786 (3.59)          24.9906 (3.57)          0.8167 (5.40)         24.9925 (3.54)          1.4373 (9.05)          3;0   40.0150 (0.28)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.CONTAINS-True-1000]                    24.5249 (3.76)          27.7205 (3.83)          25.9817 (3.71)          1.1720 (7.75)         25.7702 (3.65)          2.2304 (14.04)         5;0   38.4886 (0.27)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.EXACT-True-100]                        24.8810 (3.81)          26.5861 (3.68)          25.7411 (3.67)          0.5297 (3.50)         25.8573 (3.66)          0.7241 (4.56)          3;0   38.8484 (0.27)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.EXACT-True-1000]                       25.2014 (3.86)          26.6923 (3.69)          25.9464 (3.70)          0.5259 (3.48)         26.0475 (3.69)          0.9608 (6.05)          4;0   38.5410 (0.27)         10         100
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.EXACT-True-100]                 25.6718 (3.94)          28.1315 (3.89)          27.1845 (3.88)          0.8048 (5.32)         27.4582 (3.89)          1.4053 (8.85)          4;0   36.7857 (0.26)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.EXACT-True-10000]                      25.9051 (3.97)          27.9882 (3.87)          27.0427 (3.86)          0.6120 (4.05)         26.9807 (3.82)          0.6116 (3.85)          3;0   36.9786 (0.26)         10         100
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.CONTAINS-True-1000]             25.9609 (3.98)          27.7376 (3.84)          26.7406 (3.82)          0.5735 (3.79)         26.7907 (3.80)          1.0003 (6.30)          4;0   37.3963 (0.26)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.CONTAINS-True-10000]                   26.0414 (3.99)          28.8868 (4.00)          26.9998 (3.85)          0.9163 (6.06)         26.8297 (3.80)          1.3507 (8.50)          3;0   37.0373 (0.26)         10         100
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.CONTAINS-True-100]              27.7267 (4.25)          30.2465 (4.18)          28.7952 (4.11)          0.8299 (5.49)         28.4922 (4.04)          1.2164 (7.66)          3;0   34.7281 (0.24)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.EXACT-True-100000]                     30.3378 (4.65)          34.3165 (4.75)          32.8245 (4.68)          1.2663 (8.37)         32.8784 (4.66)          1.1486 (7.23)          4;1   30.4651 (0.21)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.CONTAINS-True-100000]                  30.7288 (4.71)          34.1435 (4.72)          32.5586 (4.65)          1.0452 (6.91)         32.6446 (4.63)          1.3427 (8.45)          4;0   30.7139 (0.22)         10         100
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.CONTAINS-True-10000]            32.9957 (5.06)          35.3824 (4.89)          34.0991 (4.87)          0.9066 (6.00)         34.1240 (4.84)          1.6901 (10.64)         3;0   29.3263 (0.21)         10         100
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.EXACT-True-1000]                42.1345 (6.46)          45.4126 (6.28)          43.6037 (6.22)          1.3520 (8.94)         43.2049 (6.12)          2.4473 (15.40)         4;0   22.9338 (0.16)         10         100
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.EXACT-True-10000]               42.6157 (6.53)          47.4081 (6.56)          44.7183 (6.38)          1.5540 (10.28)        44.5966 (6.32)          1.1881 (7.48)          4;2   22.3622 (0.16)         10         100
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.CONTAINS-True-10000000]                46.5505 (7.14)          50.6660 (7.01)          48.4341 (6.91)          1.4537 (9.61)         48.1682 (6.83)          2.1131 (13.30)         3;0   20.6466 (0.14)         10          22
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.EXACT-True-100000]              55.1695 (8.46)          82.2287 (11.38)         68.7292 (9.81)          9.0903 (60.12)        68.4261 (9.70)         14.2079 (89.43)         3;0   14.5499 (0.10)         10          15
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.CONTAINS-True-100000]           59.2771 (9.09)          80.7788 (11.17)         69.8728 (9.97)          6.2367 (41.25)        70.4318 (9.98)          8.1931 (51.57)         2;0   14.3117 (0.10)         10          15
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.CONTAINS-True-10000000]         77.9857 (11.96)        104.1672 (14.41)         92.6445 (13.22)        10.4652 (69.21)        95.4300 (13.52)        22.1740 (139.57)        5;0   10.7940 (0.08)         10          13
test_benchmark__dictionary[sqlite-lookup-LookupMode.CONTAINS-True-1000000]                         138.9597 (21.30)        175.8679 (24.33)        151.4042 (21.61)        14.2039 (93.94)       144.1459 (20.43)        27.7087 (174.41)        3;0    6.6048 (0.05)         10          10
test_benchmark__dictionary[sqlite-lookup-LookupMode.FUZZY-True-100]                                146.7854 (22.50)        227.4223 (31.46)        159.8815 (22.82)        24.2773 (160.55)      151.8537 (21.52)         8.4976 (53.49)         1;1    6.2546 (0.04)         10          10
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.EXACT-True-10000000]                  165.0900 (25.31)        369.2699 (51.08)        275.4328 (39.31)        62.9399 (416.24)      262.1624 (37.15)        67.6073 (425.54)        3;0    3.6306 (0.03)         10          10
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.EXACT-True-1000000]                   172.2281 (26.40)        213.0559 (29.47)        190.3100 (27.16)        14.3082 (94.63)       189.7028 (26.88)        27.0202 (170.07)        3;0    5.2546 (0.04)         10          10
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.CONTAINS-True-1000000]                  217.0614 (33.28)        496.0582 (68.62)        309.5674 (44.18)        89.3842 (591.13)      301.0098 (42.66)       124.4174 (783.12)        2;0    3.2303 (0.02)         10          10
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.EXACT-True-10000000]           229.5307 (35.19)      3,123.2173 (432.06)     1,558.0791 (222.36)      896.0889 (>1000.0)   1,405.3893 (199.17)      742.5614 (>1000.0)       3;1    0.6418 (0.00)         10           1
test_benchmark__dictionary[sqlite-lookup-LookupMode.FUZZY-True-1000]                               231.2601 (35.46)        256.3243 (35.46)        242.2794 (34.58)         8.4588 (55.94)       241.7708 (34.26)        11.3262 (71.29)         3;0    4.1275 (0.03)         10          10
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.EXACT-True-1000000]            255.6540 (39.19)        400.1043 (55.35)        348.7943 (49.78)        51.2785 (339.12)      356.2506 (50.49)        98.3236 (618.88)        3;0    2.8670 (0.02)         10          10
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.CONTAINS-True-1000000]         287.7460 (44.12)        488.3200 (67.55)        360.1814 (51.40)        69.0495 (456.65)      352.4058 (49.94)       105.8719 (666.39)        4;0    2.7764 (0.02)         10           3
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.FUZZY-True-100]                         345.3718 (52.95)        369.3058 (51.09)        356.0458 (50.81)         7.0267 (46.47)       356.1909 (50.48)         6.4213 (40.42)         3;1    2.8086 (0.02)         10          10
test_benchmark__dictionary[sqlite-lookup-LookupMode.FUZZY-True-10000]                              370.6342 (56.82)        406.4541 (56.23)        394.6191 (56.32)        11.0417 (73.02)       397.4427 (56.33)        10.3458 (65.12)         3;1    2.5341 (0.02)         10          10
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.FUZZY-True-1000]                        405.9040 (62.23)        452.3701 (62.58)        423.6187 (60.46)        15.3115 (101.26)      422.9941 (59.95)        16.5805 (104.36)        4;0    2.3606 (0.02)         10          10
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.FUZZY-True-1000]               995.2664 (152.59)     2,106.8920 (291.46)     1,482.0389 (211.51)      356.3375 (>1000.0)   1,394.0730 (197.57)      333.9574 (>1000.0)       4;0    0.6747 (0.00)         10           1
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.CONTAINS-True-1000000]              1,098.9702 (168.49)     1,679.5469 (232.34)     1,492.1032 (212.95)      187.6675 (>1000.0)   1,561.1204 (221.24)      188.7849 (>1000.0)       2;1    0.6702 (0.00)         10          10
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.FUZZY-True-10000]                     1,236.2008 (189.53)     1,492.6512 (206.49)     1,341.0937 (191.40)       86.7168 (573.49)    1,334.2883 (189.09)      100.6627 (633.60)        3;0    0.7457 (0.01)         10           1
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.FUZZY-True-100]              1,249.1602 (191.51)     2,605.2110 (360.40)     1,803.3754 (257.37)      452.4375 (>1000.0)   1,775.1079 (251.57)      755.3454 (>1000.0)       4;0    0.5545 (0.00)         10           1
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.FUZZY-True-100]                     1,651.3347 (253.17)     3,497.6983 (483.86)     2,713.6621 (387.29)      609.2140 (>1000.0)   2,904.0569 (411.56)    1,036.8949 (>1000.0)       3;0    0.3685 (0.00)         10           1
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.FUZZY-True-1000]                    2,439.2252 (373.96)     3,966.1945 (548.67)     3,292.9493 (469.96)      521.1677 (>1000.0)   3,391.2111 (480.60)      874.8446 (>1000.0)       4;0    0.3037 (0.00)         10           1
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.FUZZY-True-10000]                   6,821.2189 (>1000.0)   12,147.7917 (>1000.0)    9,436.6721 (>1000.0)   1,965.3413 (>1000.0)   9,467.7721 (>1000.0)   3,526.3612 (>1000.0)       4;0    0.1060 (0.00)         10           1
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.FUZZY-True-10000]            7,445.5933 (>1000.0)   15,272.3219 (>1000.0)   11,197.6434 (>1000.0)   2,340.7786 (>1000.0)  11,517.3044 (>1000.0)   3,215.3225 (>1000.0)       3;0    0.0893 (0.00)         10           1
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.FUZZY-True-100000]                    7,909.9999 (>1000.0)   10,385.6896 (>1000.0)    8,637.1084 (>1000.0)     719.9010 (>1000.0)   8,468.7711 (>1000.0)     533.4284 (>1000.0)       2;1    0.1158 (0.00)         10           1
test_benchmark__dictionary[sqlite-lookup-LookupMode.FUZZY-True-100000]                           8,107.9080 (>1000.0)    8,728.3345 (>1000.0)    8,437.2845 (>1000.0)     212.7743 (>1000.0)   8,478.6290 (>1000.0)     346.3772 (>1000.0)       4;0    0.1185 (0.00)         10           1
test_benchmark__dictionary[sqlite-lookup-LookupMode.FUZZY-True-10000000]                        11,118.0357 (>1000.0)   12,731.2212 (>1000.0)   11,660.5070 (>1000.0)     530.2743 (>1000.0)  11,527.8938 (>1000.0)     513.2379 (>1000.0)       3;1    0.0858 (0.00)         10           1
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.FUZZY-True-10000000]                 11,348.6853 (>1000.0)   12,401.8203 (>1000.0)   11,768.3677 (>1000.0)     284.5179 (>1000.0)  11,726.1019 (>1000.0)     191.7780 (>1000.0)       3;2    0.0850 (0.00)         10           1
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.FUZZY-True-100000]          36,238.0695 (>1000.0)  102,635.6379 (>1000.0)   63,169.4189 (>1000.0)  20,081.1960 (>1000.0)  64,139.6349 (>1000.0)  18,411.7789 (>1000.0)       3;1    0.0158 (0.00)          8           1
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.FUZZY-True-100000]                 43,024.5270 (>1000.0)   73,149.6718 (>1000.0)   55,207.6246 (>1000.0)   9,572.8901 (>1000.0)  53,893.2527 (>1000.0)  11,550.6236 (>1000.0)       4;0    0.0181 (0.00)          9           1
test_benchmark__dictionary[sqlite-sentence_search-LookupMode.FUZZY-True-10000000]               60,768.5540 (>1000.0)   89,716.9721 (>1000.0)   74,243.6175 (>1000.0)  12,748.0625 (>1000.0)  67,536.8484 (>1000.0)  24,092.0379 (>1000.0)       3;0    0.0135 (0.00)          7           1
test_benchmark__dictionary[sqlite-sentence_search_sorted-LookupMode.FUZZY-True-10000000]        64,548.7587 (>1000.0)   98,012.6195 (>1000.0)   77,817.8866 (>1000.0)  11,213.8817 (>1000.0)  76,933.1447 (>1000.0)   6,997.1147 (>1000.0)       2;1    0.0129 (0.00)          6           1
test_benchmark__dictionary[sqlite-lookup_sorted-LookupMode.FUZZY-True-1000000]                  81,178.9081 (>1000.0)  106,857.7571 (>1000.0)   89,765.1792 (>1000.0)  10,798.5350 (>1000.0)  84,629.1689 (>1000.0)  15,197.9241 (>1000.0)       1;0    0.0111 (0.00)          5           1
test_benchmark__dictionary[sqlite-lookup-LookupMode.FUZZY-True-1000000]                         95,876.8333 (>1000.0)  110,335.0147 (>1000.0)  100,079.2562 (>1000.0)   6,859.6685 (>1000.0)  97,052.5883 (>1000.0)   7,266.3752 (>1000.0)       1;0    0.0100 (0.00)          4           1
-----------------------------------------
  `;

                const [benchmarkData, setBenchmarkData] = useState(defaultData.trim());
                const [results, setResults] = useState([]);
                const [error, setError] = useState("");

                const parseBenchmarkData = (content) => {
                    const lines = content.trim().split("\n");
                    console.log("Found lines: ", lines.length);
                    const parsed = [];
                    for (const line of lines) {
                        if (!line.trim().startsWith("test_benchmark")) continue;
                        try {
                            const testNameMatch = line.match(/test_benchmark__[^\s]+/);
                            if (!testNameMatch) continue;
                            const testName = testNameMatch[0];
                            const bracketMatch = testName.match(/\[([^\]]+)\]/);
                            if (!bracketMatch) continue;
                            const parts = bracketMatch[1].split("-");
                            if (parts.length < 5) continue;
                            const storage = parts[0];
                            const func = parts[1];
                            const mode = parts[2];
                            const isSuccess = parts[3].toLowerCase() === "true";
                            const datasetSize = parseInt(parts[4]);
                            const pattern = /([\d,]+(?:\.\d+)?)\s+\(([\d.\>?]+)\)/g;
                            const columns = [...line.matchAll(pattern)];
                            if (columns.length >= 2) {
                                // const has_more = columns[1][0].contains(">");
                                // const meanValue = parseFloat(columns[2][0].replace(",", "").replace(">", ""));
                                const meanValue = parseFloat(columns[4][0].replace(",", "").replace(">", "")).toFixed(0);
                                parsed.push({ storage, func, mode, isSuccess, datasetSize, meanValue });
                                // console.log(`Parsed: ${storage}, ${func}, ${mode}, ${isSuccess}, ${datasetSize}, ${meanValue}`);
                            }
                        } catch (e) {
                            console.error(e);
                        }
                    }
                    console.log("Parsed lines:", parsed.length);
                    return parsed;
                };

                const handleParse = () => {
                    setError("");
                    try {
                        const parsed = parseBenchmarkData(benchmarkData);
                        if (parsed.length === 0) setError("No valid benchmark data found.");
                        else setResults(parsed);
                    } catch (e) {
                        setError("Error parsing data: " + e.message);
                    }
                };

                const formatSize = (size) => {
                    if (size >= 1000000) return `${size / 1000000}M`;
                    if (size >= 1000) return `${size / 1000}K`;
                    return size.toString();
                };

                const formatTime = (time) => {
                    if (time >= 1000) return `${(time / 1000).toFixed(1)}s`;
                    return `${time}ms`;
                };

                const generateGroupedData = () => {
                    const table = {}; // group by time bucket first

                    results.forEach((result) => {
                        let group;
                        if (result.meanValue < 50) group = "<50ms";
                        else if (result.meanValue < 100) group = "50-100ms";
                        else if (result.meanValue < 500) group = "100-500ms";
                        else if (result.meanValue < 1000) group = "1s";
                        else if (result.meanValue < 2000) group = "<2s";
                        else if (result.meanValue < 5000) group = "<5s";
                        else if (result.meanValue < 10000) group = "<10s";
                        else group = `${(result.meanValue / 1000).toFixed(0)}s`;
                        // group = `${result.meanValue}ms`;

                        const mode = result.mode.replace("LookupMode.", "");
                        const key = `${result.func}_${mode}`;

                        console.log(`key: ${key}, group: ${group}, value: ${result.meanValue}`);

                        if (!table[group]) table[group] = {};
                        // pick the bigger dataset per func+mode+bucket
                        if (!table[group][key] || result.datasetSize > table[group][key].datasetSize) {
                            table[group][key] = result;
                        }
                    });

                    // convert table to sorted array for rendering
                    const grouped = Object.entries(table)
                        .map(([timeRange, funcsObj]) => {
                            const funcs = Object.values(funcsObj)
                                .map((r) => {
                                    const mode = r.mode.replace("LookupMode.", "");
                                    const size = formatSize(r.datasetSize);
                                    const found = r.isSuccess ? "Found" : "Not Found";
                                    const time = formatTime(r.meanValue);
                                    return `${r.func} ${mode} ${size} ${found} (${time})`;
                                })
                                .sort((a, b) => a.localeCompare(b));
                            return [timeRange, funcs];
                        })
                        .sort((a, b) => {
                            const groups_order = ["<50ms", "50-100ms", "100-500ms", "1s", "<2s", "<5s", "<10s"];
                            const idxA = groups_order.indexOf(a[0]);
                            const idxB = groups_order.indexOf(b[0]);

                            if (idxA !== -1 && idxB !== -1) return idxA - idxB;
                            if (idxA !== -1) return -1;
                            if (idxB !== -1) return 1;

                            // fallback: parse numeric value, remove non-digits
                            const parseTime = (str) => parseInt(str.replace(/[^\d]/g, ""), 10);
                            return parseTime(a[0]) - parseTime(b[0]);
                        });

                    return grouped;
                };

                const groupedData = results.length > 0 ? generateGroupedData() : [];

                return (
                    <div className="min-h-screen p-8">
                        <h1 className="text-3xl font-bold mb-6">Benchmark Report Viewer</h1>
                        <div className="bg-white rounded-lg shadow-md p-6 mb-6">
                            <label className="block mb-2 font-medium">Paste Benchmark Output:</label>
                            <textarea className="w-full h-48 p-3 border rounded font-mono" value={benchmarkData} onChange={(e) => setBenchmarkData(e.target.value)} />
                            <button onClick={handleParse} className="mt-4 px-6 py-2 bg-green-600 text-white rounded hover:bg-green-700">
                                Parse & Display
                            </button>
                            {error && <div className="mt-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded">{error}</div>}
                        </div>
                        {groupedData.length > 0 && (
                            <div className="bg-white rounded shadow overflow-hidden">
                                <table className="w-full">
                                    <thead>
                                        <tr className="bg-green-600 text-white">
                                            <th className="px-6 py-3 text-left">Time Range</th>
                                            <th className="px-6 py-3 text-left">Functions & Configuration</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {groupedData.map(([timeRange, funcs], idx) => (
                                            <tr key={idx} className={idx % 2 === 0 ? "bg-gray-50" : "bg-white"}>
                                                <td className="px-6 py-4 font-semibold align-top">{timeRange}</td>
                                                <td className="px-6 py-4">
                                                    {funcs.map((func, i) => (
                                                        <div key={i} className="mb-1">
                                                            {func}
                                                        </div>
                                                    ))}
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </div>
                );
            };

            ReactDOM.createRoot(document.getElementById("root")).render(<BenchmarkViewer />);
        </script>
    </body>

    <script src="https://cdn.tailwindcss.com"></script>
</html>
